(function(a){"undefined"==typeof a.fn.each2&&a.fn.extend({each2:function(e){for(var c=a([0]),d=-1,b=this.length;++d<b&&(c.context=c[0]=this[d])&&!1!==e.call(c[0],d,c);){}return this}})})(jQuery);(function(M,L){function I(e){return e&&"string"===typeof e?e.replace("&","&amp;"):e}function J(f,e){var j=0,i=e.length,h;if("undefined"===typeof f){return -1}if(f.constructor===String){for(;j<i;j+=1){if(0===f.localeCompare(e[j])){return j}}}else{for(;j<i;j+=1){if(h=e[j],h.constructor===String){if(0===h.localeCompare(f)){return j}}else{if(h===f){return j}}}}return -1}function H(f,e){return f===e?!0:f===L||e===L||null===f||null===e?!1:f.constructor===String?0===f.localeCompare(e):e.constructor===String?0===e.localeCompare(f):!1}function b(f,e){var j,i,h;if(null===f||1>f.length){return[]}j=f.split(e);i=0;for(h=j.length;i<h;i+=1){j[i]=M.trim(j[i])}return j}function a(f,e){var h;return function(){window.clearTimeout(h);h=window.setTimeout(e,f)}}function K(e){e.preventDefault();e.stopPropagation()}function G(f,e,i){var h=f.toUpperCase().indexOf(e.toUpperCase()),e=e.length;0>h?i.push(f):(i.push(f.substring(0,h)),i.push("<span class='select2-match'>"),i.push(f.substring(h,h+e)),i.push("</span>"),i.push(f.substring(h+e,f.length)))}function F(f){var e,j=0,i=null,h=f.quietMillis||100;return function(l){window.clearTimeout(e);e=window.setTimeout(function(){var m=j+=1,s=f.data,t=f.transport||M.ajax,r=f.type||"GET",s=s.call(this,l.term,l.page,l.context);null!==i&&i.abort();i=t.call(null,{url:f.url,dataType:f.dataType,data:s,type:r,success:function(u){m<j||(u=f.results(u,l.page),l.callback(u))}})},h)}}function E(f){var e=f,i,h=function(j){return""+j.text};M.isArray(e)||(h=e.text,M.isFunction(h)||(i=e.text,h=function(j){return j[i]}),e=e.results);return function(j){var m=j.term,l={};if(m===""){j.callback({results:e})}else{l.results=M(e).filter(function(){return j.matcher(m,h(this))}).get();j.callback(l)}}}function p(e){return M.isFunction(e)?e:function(f){var i=f.term,h={results:[]};M(e).each(function(){var j=this.text!==L,l=j?this.text:this;if(""===i||f.matcher(i,l)){h.results.push(j?this:{id:this,text:this})}});f.callback(h)}}function o(e){if(M.isFunction(e)){return !0}if(!e){return fasle}throw Error("formatterName must be a function or a falsy value")}function n(e){return M.isFunction(e)?e():e}function g(f,e){var h=function(){};h.prototype=new f;h.prototype.constructor=h;h.prototype.parent=f.prototype;h.prototype=M.extend(h.prototype,e);return h}if(window.Select2===L){var N,k,d,c,q;N={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case N.LEFT:case N.RIGHT:case N.UP:case N.DOWN:return !0}return !1},isControl:function(e){e=e.which?e.which:e;switch(e){case N.SHIFT:case N.CTRL:case N.ALT:return !0}return e.metaKey?!0:!1},isFunctionKey:function(e){e=e.which?e.which:e;return 112<=e&&123>=e}};M(document).delegate("*","mousemove",function(e){M.data(document,"select2-lastpos",{x:e.pageX,y:e.pageY})});M(document).ready(function(){M(document).delegate("*","mousedown touchend",function(f){var e=M(f.target).closest("div.select2-container").get(0),h;e?M(document).find("div.select2-container-active").each(function(){this!==e&&M(this).data("select2").blur()}):(e=M(f.target).closest("div.select2-drop").get(0),M(document).find("div.select2-drop-active").each(function(){this!==e&&M(this).data("select2").blur()}));e=M(f.target);h=e.attr("for");"LABEL"===f.target.tagName&&(h&&0<h.length)&&(e=M("#"+h),e=e.data("select2"),e!==L&&(e.focus(),f.preventDefault()))})});k=g(Object,{bind:function(f){var e=this;return function(){f.apply(e,arguments)}},init:function(h){var f,r;this.opts=h=this.prepareOpts(h);this.id=h.id;h.element.data("select2")!==L&&null!==h.element.data("select2")&&this.destroy();this.enabled=!0;this.container=this.createContainer();var m=!1,j;this.body=function(){!1===m&&(j=h.element.closest("body"),m=!0);return j};h.element.attr("class")!==L&&this.container.addClass(h.element.attr("class"));this.container.css(n(h.containerCss));this.container.addClass(n(h.containerCssClass));this.opts.element.data("select2",this).hide().after(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.css(n(h.dropdownCss));this.dropdown.addClass(n(h.dropdownCssClass));this.dropdown.data("select2",this);this.results=f=this.container.find(".select2-results");this.search=r=this.container.find("input.select2-input");r.attr("tabIndex",this.opts.element.attr("tabIndex"));this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();this.results.bind("mousemove",function(s){var e=M.data(document,"select2-lastpos");(e===L||e.x!==s.pageX||e.y!==s.pageY)&&M(s.target).trigger("mousemove-filtered",s)});this.dropdown.delegate(".select2-results","mousemove-filtered",this.bind(this.highlightUnderEvent));var i=this.results,l=a(80,function(e){i.trigger("scroll-debounced",e)});i.bind("scroll",function(e){0<=J(e.target,i.get())&&l(e)});this.dropdown.delegate(".select2-results","scroll-debounced",this.bind(this.loadMoreIfNeeded));M.fn.mousewheel&&f.mousewheel(function(e,u,t,s){u=f.scrollTop();0<s&&0>=u-s?(f.scrollTop(0),K(e)):0>s&&f.get(0).scrollHeight-f.scrollTop()+s<=f.height()&&(f.scrollTop(f.get(0).scrollHeight-f.height()),K(e))});r.bind("keydown",function(){M.data(r,"keyup-change-value")===L&&M.data(r,"keyup-change-value",r.val())});r.bind("keyup",function(){var e=M.data(r,"keyup-change-value");e!==L&&r.val()!==e&&(M.removeData(r,"keyup-change-value"),r.trigger("keyup-change"))});r.bind("keyup-change",this.bind(this.updateResults));r.bind("focus",function(){r.addClass("select2-focused");" "===r.val()&&r.val("")});r.bind("blur",function(){r.removeClass("select2-focused")});this.dropdown.delegate(".select2-results","mouseup",this.bind(function(e){0<M(e.target).closest(".select2-result-selectable:not(.select2-disabled)").length?(this.highlightUnderEvent(e),this.selectHighlighted(e)):this.focusSearch();K(e)}));this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation()});M.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource());h.element.is(":disabled")&&this.disable()},destroy:function(){var e=this.opts.element.data("select2");e!==L&&(e.container.remove(),e.dropdown.remove(),e.opts.element.removeData("select2").unbind(".select2").show())},prepareOpts:function(f){var e,i,h;e=f.element;"select"===e.get(0).tagName.toLowerCase()&&(this.select=i=f.element);f.separator=f.separator||",";i&&M.each("id multiple ajax query createSearchChoice initSelection data tags".split(" "),function(){if(this in f){throw Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}});f=M.extend({},{populateResults:function(j,s,r){var m,l=this.opts.id;m=function(C,B,A){var x,z,y,u,t,v,w;x=0;for(z=C.length;x<z;x=x+1){y=C[x];u=l(y)!==L;t="children" in y&&y.children.length>0;v=M("<li></li>");v.addClass("select2-results-dept-"+A);v.addClass("select2-result");v.addClass(u?"select2-result-selectable":"select2-result-unselectable");t&&v.addClass("select2-result-with-children");u=M("<div></div>");u.addClass("select2-result-label");w=f.formatResult(y,u,r);w!==L&&u.html(I(w));v.append(u);if(t){t=M("<ul></ul>");t.addClass("select2-result-sub");m(y.children,t,A+1);v.append(t)}v.data("select2-data",y);B.append(v)}};m(s,j,0)}},M.fn.select2.defaults,f);"function"!==typeof f.id&&(h=f.id,f.id=function(j){return j[h]});if(i){f.query=this.bind(function(l){var u={results:[],more:false},t=l.term,s,r,m;m=function(j,w){var v;if(j.is("option")){l.matcher(t,j.text(),j)&&w.push({id:j.attr("value"),text:j.text(),element:j.get()})}else{if(j.is("optgroup")){v={text:j.attr("label"),children:[],element:j.get()};j.children().each2(function(y,x){m(x,v.children)});v.children.length>0&&w.push(v)}}};s=e.children();if(this.getPlaceholder()!==L&&s.length>0){r=s[0];M(r).text()===""&&(s=s.not(r))}s.each2(function(v,j){m(j,u.results)});l.callback(u)}),f.id=function(j){return j.id}}else{if(!("query" in f)){if("ajax" in f){if((i=f.element.data("ajax-url"))&&0<i.length){f.ajax.url=i}f.query=F(f.ajax)}else{"data" in f?f.query=E(f.data):"tags" in f&&(f.query=p(f.tags),f.createSearchChoice=function(j){return{id:j,text:j}},f.initSelection=function(j,m){var l=[];M(b(j.val(),f.separator)).each(function(){var r=this,t=this,s=f.tags;M.isFunction(s)&&(s=s());M(s).each(function(){if(H(this.id,r)){t=this.text;return false}});l.push({id:r,text:t})});m(l)})}}}if("function"!==typeof f.query){throw"query function not defined for Select2 "+f.element.attr("id")}return f},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(){!0!==this.opts.element.data("select2-change-triggered")&&this.initSelection()}))},triggerChange:function(e){e=e||{};e=M.extend({},e,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",!0);this.opts.element.trigger(e);this.opts.element.data("select2-change-triggered",!1);this.opts.element.click()},enable:function(){this.enabled||(this.enabled=!0,this.container.removeClass("select2-container-disabled"))},disable:function(){this.enabled&&(this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"))},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var i=this.container.offset(),f=this.container.outerHeight(),s=this.container.outerWidth(),r=this.dropdown.outerHeight(),l=M(window).scrollTop()+document.documentElement.clientHeight,f=i.top+f,l=f+r<=l,m=i.top-r>=this.body().scrollTop(),j;this.dropdown.hasClass("select2-drop-above")?(j=!0,!m&&l&&(j=!1)):(j=!1,!l&&m&&(j=!0));j?(f=i.top-r,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above"));this.dropdown.css({top:f,left:i.left,width:s})},shouldOpen:function(){var e;if(this.opened()){return !1}e=jQuery.Event("open");this.opts.element.trigger(e);return !e.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen()){return !1}window.setTimeout(this.bind(this.opening),1);return !0},opening:function(){this.clearDropdownAlignmentPreference();" "===this.search.val()&&this.search.val("");this.dropdown.addClass("select2-drop-active");this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.updateResults(!0);this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body());this.dropdown.show();this.ensureHighlightVisible();this.positionDropdown();this.focusSearch()},close:function(){this.opened()&&(this.clearDropdownAlignmentPreference(),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),this.clearSearch(),this.opts.element.trigger(jQuery.Event("close")))},clearSearch:function(){},ensureHighlightVisible:function(){var f=this.results,e,j,i,h;j=this.highlight();0>j||(0==j?f.scrollTop(0):(e=f.find(".select2-result-selectable"),i=M(e[j]),h=i.offset().top+i.outerHeight(),j===e.length-1&&(e=f.find("li.select2-more-results"),0<e.length&&(h=e.offset().top+e.outerHeight())),e=f.offset().top+f.outerHeight(),h>e&&f.scrollTop(f.scrollTop()+(h-e)),i=i.offset().top-f.offset().top,0>i&&f.scrollTop(f.scrollTop()+i)))},moveHighlight:function(f){for(var e=this.results.find(".select2-result-selectable"),i=this.highlight();-1<i&&i<e.length;){var i=i+f,h=M(e[i]);if(h.hasClass("select2-result-selectable")&&!h.hasClass("select2-disabled")){this.highlight(i);break}}},highlight:function(f){var e=this.results.find(".select2-result-selectable").not(".select2-disabled");if(0===arguments.length){return J(e.filter(".select2-highlighted")[0],e.get())}f>=e.length&&(f=e.length-1);0>f&&(f=0);e.removeClass("select2-highlighted");M(e[f]).addClass("select2-highlighted");this.ensureHighlightVisible()},countSelectableResults:function(){return this.results.find(".select2-result-selectable").not(".select2-disabled").length},highlightUnderEvent:function(f){f=M(f.target).closest(".select2-result-selectable");if(0<f.length&&!f.is(".select2-highlighted")){var e=this.results.find(".select2-result-selectable");this.highlight(e.index(f))}else{0==f.length&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")}},loadMoreIfNeeded:function(){var j=this.results,i=j.find("li.select2-more-results"),t,s=this.resultsPage+1,m=this,r=this.search.val(),l=this.context;0!==i.length&&(t=i.offset().top-j.offset().top-j.height(),0>=t&&(i.addClass("select2-active"),this.opts.query({term:r,page:s,context:l,matcher:this.opts.matcher,callback:this.bind(function(e){m.opts.populateResults.call(this,j,e.results,{term:r,page:s,context:l});!0===e.more?(i.detach().appendTo(j.children(":last")).text(m.opts.formatLoadMore(s+1)),window.setTimeout(function(){m.loadMoreIfNeeded()},10)):i.remove();m.positionDropdown();m.resultsPage=s})})))},updateResults:function(h){function f(){r.scrollTop(0);t.removeClass("select2-active");l.positionDropdown()}function u(e){r.html(I(e));f()}var t=this.search,r=this.results,s=this.opts,m,l=this;if(!(!0!==h&&(!1===this.showSearchInput||!this.opened()))){t.addClass("select2-active");if(1<=s.maximumSelectionSize&&(m=this.data(),M.isArray(m)&&m.length>=s.maximumSelectionSize&&o(s.formatSelectionTooBig,"formatSelectionTooBig"))){u("<li class='select2-selection-limit'>"+s.formatSelectionTooBig(s.maximumSelectionSize)+"</li>");return}t.val().length<s.minimumInputLength&&o(s.formatInputTooShort,"formatInputTooShort")?u("<li class='select2-no-results'>"+s.formatInputTooShort(t.val(),s.minimumInputLength)+"</li>"):(this.resultsPage=1,s.query({term:t.val(),page:this.resultsPage,context:null,matcher:s.matcher,callback:this.bind(function(e){var j;this.context=e.context===L?null:e.context;this.opts.createSearchChoice&&""!==t.val()&&(j=this.opts.createSearchChoice.call(null,t.val(),e.results),j!==L&&null!==j&&l.id(j)!==L&&null!==l.id(j)&&0===M(e.results).filter(function(){return H(l.id(this),l.id(j))}).length&&e.results.unshift(j));0===e.results.length&&o(s.formatNoMatches,"formatNoMatches")?u("<li class='select2-no-results'>"+s.formatNoMatches(t.val())+"</li>"):(r.empty(),l.opts.populateResults.call(this,r,e.results,{term:t.val(),page:this.resultsPage,context:null}),!0===e.more&&o(s.formatLoadMore,"formatLoadMore")&&(r.children().filter(":last").append("<li class='select2-more-results'>"+I(s.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){l.loadMoreIfNeeded()},10)),this.postprocessResults(e,h),f())})}))}},cancel:function(){this.close()},blur:function(){this.close();this.container.removeClass("select2-container-active");this.dropdown.removeClass("select2-drop-active");this.search[0]===document.activeElement&&this.search.blur();this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){window.setTimeout(this.bind(function(){this.search.focus();this.search.val(this.search.val())}),10)},selectHighlighted:function(){var f=this.highlight(),e=this.results.find(".select2-highlighted").not(".select2-disabled"),h=e.closest(".select2-result-selectable").data("select2-data");h&&(e.addClass("select2-disabled"),this.highlight(f),this.onSelect(h))},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){var e=function(){var f,j,i,h;if("off"===this.opts.width){return null}if("element"===this.opts.width){return 0===this.opts.element.outerWidth()?"auto":this.opts.element.outerWidth()+"px"}if("copy"===this.opts.width||"resolve"===this.opts.width){f=this.opts.element.attr("style");if(f!==L){f=f.split(";");i=0;for(h=f.length;i<h;i+=1){if(j=f[i].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/),null!==j&&1<=j.length){return j[1]}}}return"resolve"===this.opts.width?(f=this.opts.element.css("width"),0<f.indexOf("%")?f:0===this.opts.element.outerWidth()?"auto":this.opts.element.outerWidth()+"px"):null}return M.isFunction(this.opts.width)?this.opts.width():this.opts.width}.call(this);null!==e&&this.container.attr("style","width: "+e)}});d=g(k,{createContainer:function(){return M("<div></div>",{"class":"select2-container"}).html("    <a href='javascript:void(0)' class='select2-choice'>   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>   <div><b></b></div></a>    <div class='select2-drop select2-offscreen'>   <div class='select2-search'>       <input type='text' autocomplete='off' class='select2-input'/>   </div>   <ul class='select2-results'>   </ul></div>")},opening:function(){this.search.show();this.parent.opening.apply(this,arguments);this.dropdown.removeClass("select2-offscreen")},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.dropdown.removeAttr("style").addClass("select2-offscreen").insertAfter(this.selection).show())},focus:function(){this.close();this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments);this.selection.focus()},initContainer:function(){var f,e=this.dropdown;this.selection=f=this.container.find(".select2-choice");this.search.bind("keydown",this.bind(function(h){if(this.enabled){if(h.which===N.PAGE_UP||h.which===N.PAGE_DOWN){K(h)}else{if(this.opened()){switch(h.which){case N.UP:case N.DOWN:this.moveHighlight(h.which===N.UP?-1:1);K(h);break;case N.TAB:case N.ENTER:this.selectHighlighted();K(h);break;case N.ESC:this.cancel(h),K(h)}}else{h.which===N.TAB||(N.isControl(h)||N.isFunctionKey(h)||h.which===N.ESC)||this.open()}}}}));this.search.bind("focus",this.bind(function(){this.selection.attr("tabIndex","-1")}));this.search.bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active");window.setTimeout(this.bind(function(){this.selection.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)}));f.bind("mousedown",this.bind(function(h){this.opened()?(this.close(),this.selection.focus()):this.enabled&&this.open();K(h)}));e.bind("mousedown",this.bind(function(){this.search.focus()}));f.bind("focus",this.bind(function(){this.container.addClass("select2-container-active");this.search.attr("tabIndex","-1")}));f.bind("blur",this.bind(function(){this.container.removeClass("select2-container-active");window.setTimeout(this.bind(function(){this.search.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)}));f.bind("keydown",this.bind(function(i){if(this.enabled){if(i.which===N.PAGE_UP||i.which===N.PAGE_DOWN){K(i)}else{if(!(i.which===N.TAB||N.isControl(i)||N.isFunctionKey(i)||i.which===N.ESC)){this.open();if(i.which!==N.ENTER&&!(48>i.which)){var h=String.fromCharCode(i.which).toLowerCase();i.shiftKey&&(h=h.toUpperCase());this.search.val(h)}K(i)}}}}));f.delegate("abbr","mousedown",this.bind(function(h){this.enabled&&(this.clear(),K(h),this.close(),this.triggerChange(),this.selection.focus())}));this.setPlaceholder();this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}))},clear:function(){this.opts.element.val("");this.selection.find("span").empty();this.selection.removeData("select2-data");this.setPlaceholder()},initSelection:function(){if(""===this.opts.element.val()){this.close(),this.setPlaceholder()}else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(f){f!==L&&null!==f&&(e.updateSelection(f),e.close(),e.setPlaceholder())})}},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments);"select"===e.element.get(0).tagName.toLowerCase()&&(e.initSelection=function(f,i){var h=f.find(":selected");M.isFunction(i)&&i({id:h.attr("value"),text:h.text()})});return e},setPlaceholder:function(){var e=this.getPlaceholder();""===this.opts.element.val()&&e!==L&&!(this.select&&""!==this.select.find("option:first").text())&&(this.selection.find("span").html(I(e)),this.selection.addClass("select2-default"),this.selection.find("abbr").hide())},postprocessResults:function(h,f){var l=0,j=this,i=!0;this.results.find(".select2-result-selectable").each2(function(m,e){if(H(j.id(e.data("select2-data")),j.opts.element.val())){return l=m,!1}});this.highlight(l);!0===f&&(i=this.showSearchInput=h.results.length>=this.opts.minimumResultsForSearch,this.dropdown.find(".select2-search")[i?"removeClass":"addClass"]("select2-search-hidden"),M(this.dropdown,this.container)[i?"addClass":"removeClass"]("select2-with-searchbox"))},onSelect:function(f){var e=this.opts.element.val();this.opts.element.val(this.id(f));this.updateSelection(f);this.close();this.selection.focus();H(e,this.id(f))||this.triggerChange()},updateSelection:function(f){var e=this.selection.find("span");this.selection.data("select2-data",f);e.empty();f=this.opts.formatSelection(f,e);f!==L&&e.append(I(f));this.selection.removeClass("select2-default");this.opts.allowClear&&this.getPlaceholder()!==L&&this.selection.find("abbr").show()},val:function(){var f,e=null,h=this;if(0===arguments.length){return this.opts.element.val()}f=arguments[0];if(this.select){this.select.val(f).find(":selected").each2(function(i,j){e={id:j.attr("value"),text:j.text()};return !1}),this.updateSelection(e),this.setPlaceholder()}else{if(this.opts.initSelection===L){throw Error("cannot call val() if initSelection() is not defined")}f?this.opts.initSelection(this.opts.element,function(i){h.opts.element.val(!i?"":h.id(i));h.updateSelection(i);h.setPlaceholder()}):this.clear()}},clearSearch:function(){this.search.val("")},data:function(f){var e;if(0===arguments.length){return e=this.selection.data("select2-data"),e==L&&(e=null),e}!f||""===f?this.clear():(this.opts.element.val(!f?"":this.id(f)),this.updateSelection(f))}});c=g(k,{createContainer:function(){return M("<div></div>",{"class":"select2-container select2-container-multi"}).html("    <ul class='select2-choices'>  <li class='select2-search-field'>    <input type='text' autocomplete='off' style='width: 25px;' class='select2-input'>  </li></ul><div class='select2-drop select2-drop-multi' style='display:none;'>   <ul class='select2-results'>   </ul></div>")},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments);"select"===e.element.get(0).tagName.toLowerCase()&&(e.initSelection=function(f,i){var h=[];f.find(":selected").each2(function(l,j){h.push({id:j.attr("value"),text:j.text()})});M.isFunction(i)&&i(h)});return e},initContainer:function(){var e;this.searchContainer=this.container.find(".select2-search-field");this.selection=e=this.container.find(".select2-choices");this.search.bind("keydown",this.bind(function(f){if(this.enabled){if(f.which===N.BACKSPACE&&""===this.search.val()){this.close();var h;h=e.find(".select2-search-choice-focus");if(0<h.length){this.unselect(h.first());this.search.width(10);K(f);return}h=e.find(".select2-search-choice");0<h.length&&h.last().addClass("select2-search-choice-focus")}else{e.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")}if(this.opened()){switch(f.which){case N.UP:case N.DOWN:this.moveHighlight(f.which===N.UP?-1:1);K(f);return;case N.ENTER:case N.TAB:this.selectHighlighted();K(f);return;case N.ESC:this.cancel(f);K(f);return}}f.which===N.TAB||(N.isControl(f)||N.isFunctionKey(f)||f.which===N.BACKSPACE||f.which===N.ESC)||(this.open(),(f.which===N.PAGE_UP||f.which===N.PAGE_DOWN)&&K(f))}}));this.search.bind("keyup",this.bind(this.resizeSearch));this.search.bind("blur",this.bind(function(){this.container.removeClass("select2-container-active")}));this.container.delegate(".select2-choices","mousedown",this.bind(function(f){this.enabled&&(this.clearPlaceholder(),this.open(),this.focusSearch(),f.preventDefault())}));this.container.delegate(".select2-choices","focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())}));this.clearSearch()},enable:function(){this.enabled||(this.parent.enable.apply(this,arguments),this.search.removeAttr("disabled"))},disable:function(){this.enabled&&(this.parent.disable.apply(this,arguments),this.search.attr("disabled",!0))},initSelection:function(){""===this.opts.element.val()&&(this.updateSelection([]),this.close(),this.clearSearch());if(this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(f){if(f!==L&&f!==null){e.updateSelection(f);e.close();e.clearSearch()}})}},clearSearch:function(){var e=this.getPlaceholder();e!==L&&0===this.getVal().length&&!1===this.search.hasClass("select2-focused")?(this.search.val(e).addClass("select2-default"),this.resizeSearch()):this.search.val(" ").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")?this.search.val("").removeClass("select2-default"):" "===this.search.val()&&this.search.val("")},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch()},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(f){var e=[],i=[],h=this;M(f).each(function(){0>J(h.id(this),e)&&(e.push(h.id(this)),i.push(this))});f=i;this.selection.find(".select2-search-choice").remove();M(f).each(function(){h.addSelectedChoice(this)});h.postprocessResults()},onSelect:function(e){this.addSelectedChoice(e);this.select&&this.postprocessResults();this.opts.closeOnSelect?(this.close(),this.search.width(10)):(this.search.width(10),this.resizeSearch(),0<this.countSelectableResults()?this.positionDropdown():this.close());this.triggerChange({added:e});this.focusSearch()},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(h){var f=M("<li class='select2-search-choice'>    <div></div>    <a href='javascript:void(0)' class='select2-search-choice-close' tabindex='-1'></a></li>"),l=this.id(h),j=this.getVal(),i;i=this.opts.formatSelection(h,f);f.find("div").replaceWith("<div>"+I(i)+"</div>");f.find(".select2-search-choice-close").bind("click dblclick",this.bind(function(e){this.enabled&&(M(e.target).closest(".select2-search-choice").fadeOut("fast").animate({width:"hide"},50,this.bind(function(){this.unselect(M(e.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue(),K(e))})).bind("focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))}));f.data("select2-data",h);f.insertBefore(this.searchContainer);j.push(l);this.setVal(j)},unselect:function(f){var e=this.getVal(),i,h,f=f.closest(".select2-search-choice");if(0===f.length){throw"Invalid argument: "+f+". Must be .select2-search-choice"}i=f.data("select2-data");h=J(this.id(i),e);0<=h&&(e.splice(h,1),this.setVal(e),this.select&&this.postprocessResults());f.remove();this.triggerChange({removed:i})},postprocessResults:function(){var f=this.getVal(),e=this.results.find(".select2-result-selectable"),i=this.results.find(".select2-result-with-children"),h=this;e.each2(function(j,m){var l=h.id(m.data("select2-data"));0<=J(l,f)?m.addClass("select2-disabled").removeClass("select2-result-selectable"):m.removeClass("select2-disabled").addClass("select2-result-selectable")});i.each2(function(l,j){0==j.find(".select2-result-selectable").length?j.addClass("select2-disabled"):j.removeClass("select2-disabled")});e.each2(function(l,j){if(!j.hasClass("select2-disabled")&&j.hasClass("select2-result-selectable")){return h.highlight(0),!1}})},resizeSearch:function(){var h,f,l,j,i=this.search.outerWidth()-this.search.width();h=this.search;q||(l=h[0].currentStyle||window.getComputedStyle(h[0],null),q=M("<div></div>").css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:l.fontSize,fontFamily:l.fontFamily,fontStyle:l.fontStyle,fontWeight:l.fontWeight,letterSpacing:l.letterSpacing,textTransform:l.textTransform,whiteSpace:"nowrap"}),M("body").append(q));q.text(h.val());h=q.width()+10;f=this.search.offset().left;l=this.selection.width();j=this.selection.offset().left;f=l-(f-j)-i;f<h&&(f=l-i);40>f&&(f=l-i);this.search.width(f)},getVal:function(){var e;if(this.select){return e=this.select.val(),null===e?[]:e}e=this.opts.element.val();return b(e,this.opts.separator)},setVal:function(f){var e;this.select?this.select.val(f):(e=[],M(f).each(function(){0>J(this,e)&&e.push(this)}),this.opts.element.val(0===e.length?"":e.join(this.opts.separator)))},val:function(){var f,e=[],h=this;if(0===arguments.length){return this.getVal()}if(f=arguments[0]){if(this.setVal(f),this.select){this.select.find(":selected").each(function(){e.push({id:M(this).attr("value"),text:M(this).text()})}),this.updateSelection(e)}else{if(this.opts.initSelection===L){throw Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(j){var i=M(j).map(h.id);h.setVal(i);h.updateSelection(j);h.clearSearch()})}}else{this.opts.element.val(""),this.updateSelection([])}this.clearSearch()},onSortStart:function(){if(this.select){throw Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var f=[],e=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){f.push(e.opts.id(M(this).data("select2-data")))});this.setVal(f);this.triggerChange()},data:function(f){var e=this,h;if(0===arguments.length){return this.selection.find(".select2-search-choice").map(function(){return M(this).data("select2-data")}).get()}f||(f=[]);h=M.map(f,function(i){return e.opts.id(i)});this.setVal(h);this.updateSelection(f);this.clearSearch()}});M.fn.select2=function(){var h=Array.prototype.slice.call(arguments,0),f,r,m,l,j="val destroy open close focus isFocused container onSortStart onSortEnd enable disable positionDropdown data".split(" ");this.each(function(){if(0===h.length||"object"===typeof h[0]){f=0===h.length?{}:M.extend({},h[0]),f.element=M(this),"select"===f.element.get(0).tagName.toLowerCase()?l=f.element.attr("multiple"):(l=f.multiple||!1,"tags" in f&&(f.multiple=l=!0)),r=l?new c:new d,r.init(f)}else{if("string"===typeof h[0]){if(0>J(h[0],j)){throw"Unknown method: "+h[0]}m=L;r=M(this).data("select2");if(r!==L&&(m="container"===h[0]?r.container:r[h[0]].apply(r,h.slice(1)),m!==L)){return !1}}else{throw"Invalid arguments to select2 plugin: "+h}}});return m===L?this:m};M.fn.select2.defaults={width:"copy",closeOnSelect:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(f,e,h){e=[];G(f.text,h.term,e);return e.join("")},formatSelection:function(e){return e.text},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(f,e){return"Please enter "+(e-f.length)+" more characters"},formatSelectionTooBig:function(e){return"You can only select "+e+" items"},formatLoadMore:function(){return"Loading more results..."},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(f,e){return 0<=e.toUpperCase().indexOf(f.toUpperCase())}};window.Select2={query:{ajax:F,local:E,tags:p},util:{debounce:a,markMatch:G},"class":{"abstract":k,single:d,multi:c}}}})(jQuery);