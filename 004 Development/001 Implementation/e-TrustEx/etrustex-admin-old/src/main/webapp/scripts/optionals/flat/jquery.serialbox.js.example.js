(function(g){var e=g(window);var f,j,h,d;var c;var i=false;var b={};var a=function(k){return/^#|^\./.test(k)};g.fn.serialbox=function(k){var l=g.extend({},g.serialbox.defaults,k);var n=g("body");var m=this;var o=2;g.extend(this,{init:function(){if(!i){this.template()}n.off("click.serialbox").on("click.serialbox",this.selector,this.handleClick)},template:function(){f=g('<div id="serialbox"><div id="serialbox-overlay"></div><div id="serialbox-wrapper"><div id="serialbox-content"></div></div></div>').appendTo(n);j=f.find("#serialbox-overlay");h=f.find("#serialbox-wrapper");d=f.find("#serialbox-content");n.off("click.serialbox").on("click.serialbox",".js-serialbox-close",g.serialbox.close).on("click.serialbox","#serialbox-overlay, #serialbox-wrapper",g.serialbox.close).on("click.serialbox",".serialbox-item",function(p){p.stopPropagation()});i=true},handleClick:function(){var p=g(this);var q=m.handleTarget(p.data("serialbox"),p);var r=m.quicksettings(this);g.serialbox.open(q,r);return false},quicksettings:function(q){var r=g.extend({},l);for(key in g.serialbox.defaults){var p=g(q).data("serialbox-"+key);if(p){r[key]=p}}return r},handleTarget:function(s,p){if(a(s)){return s}var q=p.closest("form");if(!q.length){return s}var r=q.find("input, select, textarea").serialize();if(s.indexOf("?")==-1){r="?"+r}return s+r}});this.init();return this};g.serialbox={getMode:function(k,l){if(l!="auto"){return l}if(b[k]){return"cache"}if(a(k)){return"selector"}return"ajax"},getItem:function(n,o,m){if(o=="cache"){return b[n]}var l=(o=="iframe")?'<iframe class="serialbox-item" src="'+n+'" allowTransparency="true" border="0" frameborder="0" />':'<div class="serialbox-item" />';console.log(n);var k=g(l).hide().appendTo(d);return(m.cache)?b[n]=k:k},styles:function(k,l){k.css({"max-width":l.width,"min-height":l.height});h.css({top:e.scrollTop()})},open:function(m,l){if(c){g.serialbox.close()}var l=g.extend({},g.serialbox.defaults,l);var n=this.getMode(m,l.mode);var k=this.getItem(m,n,l);g.serialbox.settings=l;this.styles(k,l);this.display(k,m,n)},display:function(k,m,n){var l=function(){k.fadeIn();c=k};f.fadeIn();switch(n){case"cache":l();break;case"selector":g(m).appendTo(k);l();break;case"iframe":g(m).appendTo(k);l();break;case"ajax":k.load(m,l);break}},close:function(){if(!c){return}var l=g.serialbox.settings;var k=c;f.fadeOut(function(){k.hide();if(l.cache===false){k.remove()}});c=false},defaults:{width:500,height:"auto",mode:"auto",cache:false},settings:{}}})(jQuery);